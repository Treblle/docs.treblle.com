---
title: "Treblle with .NET Core"
metaTitle: "Set Up Treblle in .NET Core | Treblle Docs"
description: "Integrate Treblle with .NET Core to capture API requests, monitor errors, and improve security. Follow our setup guide to configure Treblle for real-time API insights."
image: "/og-images/treblle-netcore.jpg"
---

<div class="max-w-full mx-auto shadow-lg rounded-lg overflow-hidden">
  <a href="https://github.com/Treblle/treblle-net-core" title="View source on GitHub" aria-label="View source on GitHub" class="relative no-underline">
    <div>
      <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
      </svg>
    </div>
    <div class="grid grid-cols-4 gap-4 px-2 py-2">
      <div class="col-span-4">
      	<h3 class="text-xl font-semibold">treblle-net-core</h3>
      	<p class="text-sm font-medium">
          The official Treblle SDK for .NET Core. Seamlessly integrate Treblle to manage communication with your dashboard, send errors, and secure sensitive data.
        </p>
      </div>
    </div>
  </a>
</div>

## Requirements
- .NET: 6.0+
- ASP.NET Core: 6.0+
- C#: 10.0+

**Supported Platforms:**
- Windows, macOS, Linux
- Docker containers
- Azure, AWS, Google Cloud
- Any hosting platform supporting .NET 8+

**Supported API Types:**
- REST APIs with Controllers
- Minimal APIs
- Web APIs
- Mixed controller/minimal API applications

## Installation

You can install Treblle .NET Core via [NuGet](https://www.nuget.org/packages/Treblle.Net.Core/). Simply run the following command:

```bash
dotnet add package Treblle.Net.Core
```

## Get Your Credentials

Get your SDK Token and API Key from the [Treblle Dashboard](https://platform.treblle.com).

## Configuration

Treblle v2.0 now supports **automatic endpoint discovery**, so you no more need to manually add `[Treblle]` attributes. 

Choose from these configuration options:

#### Option A: Environment Variables (Recommended for Production)

```bash
export TREBLLE_SDK_TOKEN=your_sdk_token
export TREBLLE_API_KEY=your_api_key
```

Then use zero-configuration setup:

```csharp
using Treblle.Net.Core;

// Register Treblle Services
builder.Services.AddTreblle();

// Build your application
var app = builder.Build();

// Enable the Treblle Middleware
app.UseTreblle();
```

> **Where to place this code:**
> - **Program.cs** (new minimal hosting model): Add `builder.Services.AddTreblle()` before `builder.Build()` and `app.UseTreblle()` after `var app = builder.Build()`
> - **Startup.cs** (legacy): Add `services.AddTreblle()` in `ConfigureServices()` and `app.UseTreblle()` in `Configure()`
> - **Web API templates**: Place after authentication/authorization middleware but before routing

### Using .env Files with DotNetEnv

For development environments, you can use `.env` files:

```bash
dotnet add package DotNetEnv
```

Create a `.env` file in your project root:
```
TREBLLE_SDK_TOKEN=your_sdk_token
TREBLLE_API_KEY=your_api_key
```

Then load the environment variables:

```csharp
using Treblle.Net.Core;
using DotNetEnv;

// Load environment variables from .env file
Env.Load();

// Register Treblle Services
builder.Services.AddTreblle();

var app = builder.Build();
app.UseTreblle();
```

#### Option B: appsettings.json

```json
{
  "Treblle": {
    "SdkToken": "your_sdk_token",
    "ApiKey": "your_api_key"
  }
}
```

```csharp
using Treblle.Net.Core;

builder.Services.AddTreblle();

var app = builder.Build();
app.UseTreblle();
```

#### Option C: Manual Configuration

```csharp
using Treblle.Net.Core;

builder.Services.AddTreblle("your_sdk_token", "your_api_key");

var app = builder.Build();
app.UseTreblle();
```

That's it! Treblle will now **automatically track all your API endpoints**.

## Advanced Configuration

Treblle offers several configuration options for fine-tuning:

| Option | Default | Description |
|--------|---------|-------------|
| `ExcludedPaths` | `null` | Exclude specific paths or endpoints from Treblle |
| `DebugMode` | `false` | Enable detailed logging for troubleshooting |
| `DisableMasking` | `false` | Disable data masking if not needed |

**Example with all options:**

```csharp
using Treblle.Net.Core;

builder.Services.AddTreblle(options =>
{
    options.ExcludedPaths = new[] { "/health", "/admin/*", "/swagger/*" };
    options.DebugMode = true;
    options.DisableMasking = false;
});

var app = builder.Build();
app.UseTreblle();
```

### Debug Mode

Enable debug mode for troubleshooting and development:

```csharp
using Treblle.Net.Core;

// Option 1: Via configuration options
builder.Services.AddTreblle(options =>
{
    options.DebugMode = true;
});

// Option 2: Via AddTreblle parameter
builder.Services.AddTreblle("YOUR_SDK_TOKEN", "YOUR_API_KEY", null, disableMasking: false, debugMode: true);

var app = builder.Build();
app.UseTreblle();
```

**Debug Information Provided:**
- SDK Token and API Key validation messages
- Endpoint processing status
- JSON parsing issues in request/response bodies
- Payload size limit notifications (>5MB)
- Network transmission errors
- Middleware initialization status

To see debug messages in the console, ensure your logging configuration allows Debug level messages:

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Treblle.Net.Core": "Debug"
    }
  }
}
```

### Excluding Endpoints or Paths

By default, Treblle tracks **all endpoints** automatically. You can exclude specific paths using wildcard patterns:

```csharp
using Treblle.Net.Core;

builder.Services.AddTreblle(options =>
{
    options.ExcludedPaths = new[] { "/health", "/metrics", "/admin/*" };
});

var app = builder.Build();
app.UseTreblle();
```

**Advanced Exclusion Patterns:**

```csharp
builder.Services.AddTreblle(options =>
{
    options.ExcludedPaths = new[] 
    {
        "/health",           // Exact match
        "/metrics",          // Exact match  
        "/admin/*",          // Wildcard: excludes /admin/users, /admin/settings, etc.
        "/api/v*/internal",  // Complex wildcard: excludes /api/v1/internal, /api/v2/internal, etc.
        "/debug/*",          // Wildcard: excludes all debug endpoints
        "/_*"                // Wildcard: excludes all endpoints starting with underscore
    };
});
```

**Common Exclusion Examples:**

```csharp
options.ExcludedPaths = new[]
{
    // Health checks and monitoring
    "/health", "/healthz", "/ready", "/live",
    "/metrics", "/prometheus",
    
    // Admin and internal APIs
    "/admin/*", "/internal/*", "/_*",
    
    // Static assets (if serving through API)
    "/assets/*", "/static/*", "/public/*",
    
    // Development endpoints
    "/swagger/*", "/debug/*", "/dev/*"
};
```

### Custom Field Masking

To expand the list of fields you want to hide, pass a dictionary of property names and their corresponding maskers:

```csharp
using Treblle.Net.Core;

builder.Services.AddTreblle(
    builder.Configuration["Treblle:SdkToken"],
    builder.Configuration["Treblle:ApiKey"],
    new Dictionary<string, string> 
    { 
        { "customerCreditCard", "CreditCardMasker" }, 
        { "firstName", "DefaultStringMasker" } 
    }
);

var app = builder.Build();
app.UseTreblle();
```

**Available Maskers:**

```csharp
// DefaultStringMasker
masker.Mask("Hello World");   // output: ***********
masker.Mask("1234-5678");     // output: **********

// CreditCardMasker
masker.Mask("1234-5678-1234-5678"); // output: ****-****-****-5678
masker.Mask("1234567812345678");    // output: ****-****-****-5678

// DateMasker
masker.Mask("24-12-2024");   // output: 24-12-****

// EmailMasker
masker.Mask("user123@example.com");  // output: *******@example.com

// PostalCodeMasker
masker.Mask("SW1A 1AA");   // output: SW1A ***

// SocialSecurityMasker
masker.Mask("123-45-6789");   // output: ***-**-6789
```

### Disabling Data Masking

For high-volume scenarios where data masking is not required, you can disable it entirely to improve performance:

```csharp
using Treblle.Net.Core;

// Option 1: Via AddTreblle parameter
builder.Services.AddTreblle("YOUR_SDK_TOKEN", "YOUR_API_KEY", null, disableMasking: true);

// Option 2: Via configuration options
builder.Services.AddTreblle(options =>
{
    options.DisableMasking = true;
});

var app = builder.Build();
app.UseTreblle();
```

**Performance Impact:** Disabling masking can reduce memory usage by up to 70% for large payloads.

## Using Treblle with Controllers

With v2.0, **no attributes are required** - all controller endpoints are automatically tracked. However, you can still use the `[Treblle]` attribute for explicit control if needed:

```csharp
[Treblle]
public class ProductsController : ControllerBase
{
    public IActionResult GetProducts() => Ok(); // Automatically tracked
    
    public IActionResult CreateProduct() => Ok(); // Automatically tracked
}
```

## Using Treblle with Minimal APIs

Minimal APIs are also automatically tracked. For explicit control, you can still use `UseTreblle()` on specific endpoints:

```csharp
// Automatically tracked
app.MapGet("/products", () => "All products");

// Explicitly marked (optional)
app.MapGet("/users", () => "All users")
    .UseTreblle();
```

## Upgrading from v1.x to v2.0

Treblle .NET Core v2.0 introduces major improvements with breaking changes. Here's how to migrate:

### Update Package Reference

```xml
<PackageReference Include="Treblle.Net.Core" Version="2.0.0" />
```

### Update SDK Initialization

```csharp
// ❌ v1.x
builder.Services.AddTreblle(
    builder.Configuration["Treblle:ApiKey"], 
    builder.Configuration["Treblle:ProjectId"]);

// ✅ v2.0
builder.Services.AddTreblle(); 
```

### Update Configuration

**appsettings.json:**

```json
// ❌ v1.x
{
  "Treblle": {
    "ApiKey": "your_api_key",
    "ProjectId": "your_project_id"
  }
}

// ✅ v2.0
{
  "Treblle": {
    "SdkToken": "your_sdk_token",
    "ApiKey": "your_api_key"
  }
}
```

### Remove Manual Attributes (Optional)

```csharp
// ❌ v1.x - Required attributes
[Treblle]
public class ProductsController : ControllerBase
{
    [Treblle]
    public IActionResult GetProducts() => Ok();
}

// ✅ v2.0 - Automatic tracking
public class ProductsController : ControllerBase
{
    public IActionResult GetProducts() => Ok();
}
```

## Running Treblle Only in Production

You can conditionally enable Treblle based on the environment:

```csharp
if (app.Environment.IsProduction())
{
    app.UseTreblle();
}
```

## Support

If you have problems of any kind, feel free to reach out via email support@treblle.com and we'll do our best to help you out.